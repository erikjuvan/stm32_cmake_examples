////////////////////////////////////////////////////////////////////////////////
/**
 * @file     apptime.h
 * @brief    Application time keeping functions.
 */
////////////////////////////////////////////////////////////////////////////////
/**
 * @addtogroup APPTIME_API
 * @{ <!-- BEGIN GROUP -->
 */
////////////////////////////////////////////////////////////////////////////////

#ifndef _APPTIME_H_
#define _APPTIME_H_

////////////////////////////////////////////////////////////////////////////////
// Includes
////////////////////////////////////////////////////////////////////////////////
#include "stm32g4xx.h"
#include <stdbool.h>
#include <stdint.h>

////////////////////////////////////////////////////////////////////////////////
// Definitions
////////////////////////////////////////////////////////////////////////////////

/**
 * Type for time keeping.
 */
typedef uint32_t apptime_t;

////////////////////////////////////////////////////////////////////////////////
// Functions
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
/**
 *   Get application time in milliseconds - since boot.
 *
 * @return       Time.
 */
////////////////////////////////////////////////////////////////////////////////
static inline apptime_t apptime_get_ms(void)
{
    return HAL_GetTick();
}

////////////////////////////////////////////////////////////////////////////////
/**
 *   Get elapsed time in milliseconds since starting time.
 *
 * @param[in]    start_ms     Start time.
 * @return       Elapsed time.
 */
////////////////////////////////////////////////////////////////////////////////
static inline apptime_t apptime_get_elapsed_ms(const apptime_t start_ms)
{
    return (apptime_get_ms() - start_ms);
}

////////////////////////////////////////////////////////////////////////////////
/**
 *   Check if at least expected amount of milliseconds elapsed since starting time.
 *
 * @param[in]    start_ms     Start time.
 * @param[in]    elapsed_ms   Expected elapsed time.
 * @return       True if elapsed.
 */
////////////////////////////////////////////////////////////////////////////////
static inline bool apptime_is_elapsed_ms(const apptime_t start_ms, const apptime_t elapsed_ms)
{
    return (bool)(apptime_get_elapsed_ms(start_ms) >= elapsed_ms);
}

#endif // _APPTIME_H_
////////////////////////////////////////////////////////////////////////////////
/**
 * @} <!-- END GROUP -->
 */
////////////////////////////////////////////////////////////////////////////////
